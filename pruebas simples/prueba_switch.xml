<sequence name='swich_prueba'>
    <!-- 
        Aca comenzamos la iteración capturando un valor, en este caso, el path con la dirección al endpoint al que debe ir. Almacenamos en la propiedad source este valor, para despues ser evaluado con una condición. 
    -->

    <log level='custom' category='INFO'>
        <property name='VALOR_DE_REST' expression="concat('Este es el valor de REST_URL_POSTFIX: ', get-property('axis2', 'REST_URL_POSTFIX'))" />
    </log>

    <switch source='$axis2:REST_URL_POSTFIX'>
        <!-- 
            Case, sirve para declarar un caso condicional, esto quiere decir, que si se cumple la condición se ejecutaran todos los mediators que esten dentro de este caso. Si no se cumple, procedera a otro caso, y se ignorara este. Importante el orden de iteración es muy importante.
        -->
        <case regex='.*users.*'>
            <log level='custom' category='INFO'>
                <property name='PRIMERO' value='Entramos en el primer case'/>
            </log>
                <property name='REST_URL_POSTFIX' action='remove' scope='axis2' />
            <send>
                <endpoint>
                    <address uri='https://localhost:8243/e-comerce/1/products' />
                </endpoint>
            </send>
        </case>
        <case regex='.*products.*'>
            <log level='custom' category='INFO'>
                <property name='SEGUNDO' value='Entramos en el segundo case'/>
            </log>
            <property name='REST_URL_POSTFIX' action='remove' scope='axis2' />
            <send>
                <endpoint>
                    <address uri='https://localhost:8243/e-comerce/1/products' />
                </endpoint>
            </send>
        </case>
        <!-- 
            Default: Solo se ejecutará si, ningun caso cumple con las condiciones. Es decir lo podemos considerar como si fuera un else, y cada caso un if. Si default, no se declará, simplemete se ignorará todo dentro del swich, y continuara con el flujo. 
        -->
        <default>
            <log level='custom' category='INFO'>
                <property name='DEFAULT' value='Entramos en el default'/>
            </log>
            <property name='REST_URL_POSTFIX' action='remove' scope='axis2' />
            <send>
                <endpoint>
                    <address uri='https://pokeapi.co/api/v2/pokemon/bulbasaur' />
                </endpoint>
            </send>
        </default>
    </switch>
</sequence>